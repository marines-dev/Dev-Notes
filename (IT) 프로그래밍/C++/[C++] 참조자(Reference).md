# [C++] 참조자(Reference)

# 참조자(Reference)

참조자(&)를 이용해 참조자 변수를 선언하고 이미 할당된 메모리 공간인 원본 변수로 초기화하면, 또 다른 별명을 붙여 하나의 메모리 공간에 둘 이상의 변수 이름을 사용할 수 있다. 포인터 변수는 자신의 메모리 주소에 다른 변수의 주소 값을 저장하여 참조하지만, 참조자 변수는 하나의 변수 메모리 주소에 또 다른 이름을 붙여 참조하기 때문에 메모리를 절약할 수 있다.

ex) 포인터

int n = 8;

int *p = null;

p = &n; //&주소 지정 연산자를 사용하여 nData의 주소값을 대입한다.

ex) 참조자

int n = 8;

int &r  = n;

### **참조자 변수 선언하기**

참조자 변수는 선언과 동시에 원본 변수로만 초기화를 해야 한다. 원본 변수로 사용할 수 있는 변수로는 일반 변수, 포인터 변수, 참조자 변수를 참조할 수도 있고, 하나의 원본 변수에 여러 개의 참조자 변수를 선언할 수 있다. 주의할 점은 const 변수는 상수화된 변수이기 때문에 참조가 가능하지만, 상수로는 초기화할 수는 없다. 또한 초기화를 하지 않거나, null로 초기화할 수 없기 때문에 이런 경우에는 포인터를 사용한다. 그리고 참조 변수 선언 이후에 다른 변수의 메모리로 대상을 상수를 참조할 수도 없다.

- *자료형* &*변수이름* = *원본변수*;

ex) int n = 0;

int &r = n;

int &r2 = n;

int *p = &n;

int &r3 = *P;

int &r4 = r3;

int const n2 = 0;

int &r5 = n2;

int &r6 = 10; //(x)

int &r7 = null; //(x)

int &r8; //(x)

&r = n2; //(x)

### **참조자 변수 사용하기**

- *변수이름* = *값*;

```cpp
//참조자 변수 사용하기
#include <stdio.h>

int main()
{
    int n = 1;
    int &r1 = n;
    int &r2= n;
    int &r3 = r2;
 
    r1 = 2;
    r2 = 3;
    r3 = 4;
 
    return 0;
}
```

<aside>
💡

**함수 매개변수의 호출 방식**

함수의 호출 시 매개변수가 Call by value와 Call by reference에 따라서 함수의 호출 방식을 나눌 수 있다.

- Call by value : 인자로 값을 전달하여 매개변수로 복사하는 함수 호출 방식으로, 일반 변수이다.
- Call by reference : 인자의 주소 값을 매개변수로 전달해 함수 내부에서 외부의 변수를 참조하는 호출 방식으로, 포인터, 참조자가 있다. 이때, 참조자는 선언과 동시에 원본 변수로 초기화를 해야 하는데, 함수 호출 시 전달되는 인자로 매개변수의 초기화가 진행되기 때문에 사용이 가능한 것이다.

**예제1) Call by reference를 이용한 Swap() 구현하기**

```cpp
#include <stdio.h>

void Swap(int &_rA, int &_rB);
 
int main()
{
    int n1 = 15;
    int n2 = 30;
    Swap(n1, n2);
 
    return 0;
}
 
void Swap(int &_rA, int &_rB)
{
    int temp = _rA; //_rA 백업
    _rA = _rB; // _rA값을 _rB로 변경.
    _rB = temp; //_rB에 _rA의 값으로 변경.
}
```

</aside>

<aside>
💡 **반환형이 참조형인 함수**

- 참조형 반환을 해서 참조형 변수에 저장
    
    일반 자료형을 반환할 경우 생성된 임시 변수는 상수이기 때문에 일반 변수에만 대입할 수 있다.
    
    그러나 참조형 반환일 경우 참조형 변수를 참조하는 참조형 임시 변수가 생성되고 반환되서 참조형 변수에 저장할 수 있게 된다. 이때, 참조형을 반환할 경우 주의할 점은, 참조형 매개변수를 참조하지 않고, 함수 안의 지역 변수를 참조할 경우 지역변수는 반환과 동시에 함수와 함께 소멸되기 때문에 소멸된 변수를 참조하는 것과 같다. 그러기 때문에 참조형 매개변수만 참조형으로 반환할 수 있다.
    
- 참조형 반환을 해서 일반 변수에 저장
    
    일반 변수에 참조형 임시 변수의 값이 저장된다.
    

**예제2) 반환형이 참조형일 경우 참조형 변수에 저장하기**

```cpp
#include <stdio.h>
int& ReturnRefFunc(int &_r);
 
int main()
{
    int n = 10;
    int &r = ReturnRefFunc(n); //_r의 임시 변수 대입
    r = 30; //n의 값이 30으로 변경된다.

    return 0;
}
 
int & ReturnRefFunc(int & _r) //int &r = n;
{
    _r = 20; //n의 값이 20으로 변경된다.
 
    return _r; //반환시 _r의 임시 변수 생성
}
```

**예제3) 반환형이 참조형일 경우 일반 변수에 저장하기**

```cpp
#include <stdio.h>
int& ReturnRefFunc(int &_r);
 
int main()
{
    int n = 10;
    int result = ReturnRefFunc(n); //result = _r;(_r의 임시 변수의 값 대입)
    result = 30; //일반 변수 result의 값이 변경되어도 n의 값은 변경되지 않는다.
 
    return 0;
}
 
int & ReturnRefFunc(int & _r) //int &_r = n;
{
    _r = 20; //n = 20;
    
    return _r; //반환시 _r의 임시 변수 생성
}
```

</aside>

<aside>
💡 **const 참조자**

const 키워드를 붙여서 참조자 변수의 원본 변수의 값을 변경하지 못하도록 막을 수 있다. 또한 함수의 매개변수가 const 참조자 변수(call by reference)일 경우 상수(임시 변수 생성)를 인수로 받아 일반 변수를 참조하는 참조형 매개변수처럼 활용할 수 있다.

- const *자료형* &*변수이름* = *원본변수*;
</aside>

### r-value 참조자

r-value 참조자(&&)는 참조형 변수를 선언하여 상수를 참조할 수 있다. const 참조자와 같은 원리로 상수의 임시 변수를 생성해서 참조하는데,  const 참조자는 상수형 변수나 상수만 참조할 수 있다.

**r-value 참조자 선언하기**

- *자료형* && *변수이름* = *변수·상수*;

**r-value 참조자 변수 사용하기**

- *변수이름* = *값*;

**예제4) r-value 참조자 변수 사용하기**

```cpp
#include <stdio.h>

int CommonFunc(int _n)
{
    int n = _n * 6;
    return n;
}
 
int RefFunc(int &_r)
{
    _r = 70;
    return _r;
}
 
int ConstRefFunc(const int &_r)
{
    return _r; //_r = 45; //오류 발생 : const인 _r 값을 변경할 수 없다.
}
 
 
int main()
{
    int &&r1 = 10; //상수 10(임시 변수)을 참조한다.
    r1 = 20; //임시 변수의 값을 20으로 변경한다.
 
    int &&r2 = 15 + 15; //상수 30을 참조한다.
 
    int n1 = 30;
    //int &r2 = n + 10; //오류 발생 : n + 10은 15인 상수이기 때문에 일반 참조자에는 대입할 수 없다.
    int && r3 = n1 + 10; // 상수 40(임시 변수)을 참조한다.
    r3 = 50; //임시 변수 값을 50으로 변경한다.

    int &&r1 = CommonFunc(10); //임시 변수 60을 참조한다.

    int n2 = 0;
    int &&r2 = RefFunc(n2); //임시 변수 70을 참조한다.
    r2 = 80; //임시 변수 값을 80으로 변경한다.

    int &&r3 = ConstRefFunc(90); //임시 변수 90을 참조한다.
    r3 = 100; //임시 변수 값을 100으로 변경한다.
 
    return 0;
}
```